# TestZadanie
Описание проекта
Приложение, написанное на языке Go, для управления задачами с использованием базы данных PostgreSQL. Проект реализован с применением чистой архитектуры, что обеспечивает модульность, тестируемость и независимость бизнес-логики от внешних систем (например, базы данных или HTTP-фреймворков). 
Основные возможности:

Создание, получение, обновление и удаление задач.
Параллельное создание тестовых задач через отдельный эндпоинт.
Периодическая проверка и удаление завершённых задач (каждые 5 минут) с помощью таймера.
Логирование всех операций в текстовый файл logs.txt.
Swagger-документация API, доступная через веб-интерфейс.

Используемые технологии

Язык программирования: Go
База данных: PostgreSQL
Маршрутизация HTTP: gorilla/mux
Логирование: logrus (вывод в logs.txt)
Документация API: Swagger (swaggo/http-swagger)
Архитектура: Чистая архитектура (слои: model, service, repository, handler, timer)

Структура проекта

cmd/main.go: Точка входа приложения, инициализация компонентов и запуск HTTP-сервера.
internal/model/model.go: Определяет структуру задачи (Task).
internal/config/config.go: Настройка подключения к базе данных.
internal/repository/task_repository.go: Взаимодействие с базой данных (SQL-запросы).
internal/service/task_service.go: Бизнес-логика приложения.
internal/handler/task_handler.go: Обработка HTTP-запросов.
internal/timer/timer.go: Периодическая проверка завершённых задач.
docs/: Сгенерированная Swagger-документация (swagger.json, swagger.yaml).

Инструкции по запуску
Требования

Установленный Go (версия 1.16 или выше).
Установленный PostgreSQL (версия 12 или выше).

Шаги для запуска

Клонируйте репозиторий:
```git clone <URL-репозитория>```
```cd task-manager```


Настройте базу данных PostgreSQL:

Создайте базу данных:
psql -U postgres
```SQL
CREATE DATABASE task_manager;
```


Создайте таблицу tasks:\c task_manager
```SQL
CREATE TABLE tasks (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    status INTEGER NOT NULL,
    created_at TIMESTAMP NOT NULL
);
```




Настройте подключение к базе данных:

Откройте файл internal/config/config.go и обновите строку подключения:connStr := "user=postgres password=ВАШ_ПАРОЛЬ dbname=task_manager sslmode=disable"

Замените ВАШ_ПАРОЛЬ на пароль для пользователя postgres.


Установите зависимости:
```go mod tidy```


Сгенерируйте Swagger-документацию:
```swag init```

Это создаст файлы docs/swagger.json и docs/swagger.yaml.

Запустите приложение:
```go run cmd/main.go```


Сервер запустится на порту 8080.
Логи будут записываться в файл logs.txt в корневой папке проекта. Если файл отсутствует, он создаётся автоматически.
Таймер начнёт проверять завершённые задачи каждые 5 минут.


Откройте Swagger UI:

Перейдите в браузере по адресу: http://localhost:8080/swagger/index.html.
Используйте веб-интерфейс для тестирования API.



Примеры использования
1. Создание задачи
Создайте новую задачу с помощью POST-запроса:
```
{
"title":"Новая задача",
"description":"Описание задачи",
"status":0
}
```

Ответ:
```
{
  "id": 1,
  "title": "Новая задача",
  "description": "Описание задачи",
  "status": 0,
  "created_at": "2025-06-22T13:45:30Z"
}
```

2. Получение всех задач
Получите список всех задач:
curl http://localhost:8080/tasks

Ответ:
```
[
  {
    "id": 1,
    "title": "Новая задача",
    "description": "Описание задачи",
    "status": 0,
    "created_at": "2025-06-22T13:45:30Z"
  }
]
```
3. Получение задачи по ID
Получите задачу с ID 1:
curl http://localhost:8080/tasks/1

Ответ:
```
{
  "id": 1,
  "title": "Новая задача",
  "description": "Описание задачи",
  "status": 0,
  "created_at": "2025-06-22T13:45:30Z"
}
```

4. Обновление задачи
Обновите задачу с ID 1:
```
{
"title":"Обновлённая задача",
"description":"Новое описание",
"status":1
}
```

Ответ:
"Задача обновлена"

5. Удаление задачи
Удалите задачу с ID 1:
DELETE http://localhost:8080/tasks/1

Ответ:
"Задача удалена"

6. Создание тестовых задач
Создайте 5 тестовых задач параллельно:
curl -X POST http://localhost:8080/tasks/test-create

Ответ:
"Тестовые задачи созданы"

Проверьте созданные задачи:
curl http://localhost:8080/tasks

7. Проверка логов
Откройте файл logs.txt, чтобы просмотреть логи операций, например:
```
{"level":"info","msg":"Сервер запускается на :8080","time":"2025-06-22T13:45:00Z"}
{"level":"info","msg":"Задача создана: 1","time":"2025-06-22T13:45:30Z"}
{"level":"info","msg":"Получены все задачи","time":"2025-06-22T13:46:00Z"}
```
Дополнительные замечания

Статусы задач:
0: Новая
1: В процессе
2: Выполнена

Таймер каждые 5 минут проверяет задачи со статусом 2 (Выполнена), выводит их в консоль и удаляет из базы данных.
Логи записываются в logs.txt в формате JSON для удобного анализа.
Для тестирования используйте Swagger UI (http://localhost:8080/swagger/index.html) или утилиты вроде curl или Postman.

